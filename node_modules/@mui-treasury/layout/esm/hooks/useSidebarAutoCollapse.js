import { useEffect, useRef } from "react";
import { keys } from "@material-ui/core/styles/createBreakpoints";
import { useScreen } from "./useScreen";
import { useLayoutCtx } from "../contexts";
export var useSidebarAutoCollapse = function useSidebarAutoCollapse(sidebarId) {
  var _useLayoutCtx = useLayoutCtx(),
      collapsedBp = _useLayoutCtx.data.global.autoCollapse[sidebarId],
      setCollapsed = _useLayoutCtx.setCollapsed;

  var screen = useScreen();
  var prevScreen = useRef(screen);
  useEffect(function () {
    if (collapsedBp && screen && prevScreen.current) {
      if (screen === prevScreen.current && keys.indexOf(screen) <= keys.indexOf(collapsedBp)) {
        // first mount on browser
        setCollapsed(sidebarId, true);
      } // when viewport changes


      if (screen !== prevScreen.current) {
        if (keys.indexOf(prevScreen.current) <= keys.indexOf(collapsedBp) && keys.indexOf(collapsedBp) < keys.indexOf(screen)) {
          setCollapsed(sidebarId, false);
        }

        if (keys.indexOf(prevScreen.current) > keys.indexOf(collapsedBp) && keys.indexOf(collapsedBp) >= keys.indexOf(screen)) {
          setCollapsed(sidebarId, true);
        }

        prevScreen.current = screen;
      }
    }
  }, [screen]);
};
export default useSidebarAutoCollapse;